# 空間模式分析工具 (Spatial Pattern Analysis Tool)

這是一個用於分析空間點模式分布的圖形化工具，基於 Ripley's K 和 L 函數進行分析。本工具提供直觀的圖形介面，讓使用者能夠輕鬆地分析空間數據中的聚集、分散或隨機分布模式。

## 功能特點

- 支援多種檔案格式（CSV、Excel）
- 靈活的欄位映射設定
- 多種空間模式分析（原始、隨機、聚集、規則）
- 互動式視覺化結果
- 高解析度圖表輸出
- 分析結果匯出功能
- 支援多種細胞類型分析

## 系統需求

- Windows 作業系統
- Python 3.10 或更新版本
- 至少 4GB RAM
- 建議螢幕解析度 1920x1080 或更高

## 安裝說明

1. 確保您的系統已安裝 Python 3.8 或更新版本
2. 下載本專案的所有檔案
3. 執行 `setup.bat` 進行環境設定與套件安裝
4. 安裝完成後，執行 `start.bat` 啟動程式

## 使用說明

### 1. 載入數據

- 點擊「Open File」按鈕選擇數據檔案
- 支援的檔案格式：CSV、Excel (.xlsx, .xls)
- 在預覽視窗中設定欄位映射：
  - X 座標欄位
  - Y 座標欄位
  - 細胞類型欄位（可選）

### 2. 分析設定

- 選擇要分析的空間模式類型：
  - Original：原始分布
  - Random：隨機分布
  - Cluster：聚集分布
  - Regular：規則分布
- 設定分析參數：
  - Scan Scope：掃描範圍
  - Shrink Factor：收縮因子
  - Number of Radii：半徑數量

### 3. 執行分析

- 點擊「Run Analysis」開始分析
- 分析結果將顯示在右側面板
- 可使用滑鼠滾輪進行縮放
- 支援拖曳平移視圖

### 4. 匯出結果

- 點擊「Export Figure」匯出圖表
- 支援的格式：PNG、PDF、SVG
- 點擊「Export Results」匯出分析數據
- 支援的格式：CSV、Excel

## 關鍵演算法說明

### Ripley's K 函數

Ripley's K 函數是空間點模式分析中最常用的方法之一，用於評估點在不同空間尺度下的分布特徵：

\[ K(r) = \frac{A}{n^2} \sum_{i=1}^{n} \sum_{j=1}^{n} I(d_{ij} \leq r) \]

其中：
- A 是研究區域的面積
- n 是點的數量
- d_{ij} 是點 i 和點 j 之間的距離
- I() 是指示函數

### Ripley's L 函數

L 函數是 K 函數的變形，用於更容易解釋結果：

\[ L(r) = \sqrt{\frac{K(r)}{\pi}} - r \]

L 函數的解釋：
- L(r) > 0：表示在距離 r 處有聚集
- L(r) < 0：表示在距離 r 處有分散
- L(r) = 0：表示在距離 r 處為隨機分布

## 注意事項

1. 數據檔案必須包含有效的座標資訊
2. 座標值應為數值型態
3. 建議數據量不要超過 100,000 點
4. 分析大量數據時可能需要較長時間

## 常見問題

1. Q: 為什麼我的圖表顯示不完整？
   A: 請使用滑鼠滾輪進行縮放，或使用拖曳功能移動視圖。

2. Q: 如何正確設定欄位映射？
   A: 在預覽視窗中，選擇包含 X、Y 座標的欄位，如果有細胞類型資訊，也請選擇相應欄位。

3. Q: 分析結果如何解釋？
   A: 請參考「關鍵演算法說明」部分，了解 L 函數的解釋方式。

## 授權說明

本軟體採用 MIT 授權條款。詳見 LICENSE 檔案。

## 聯絡資訊

如有任何問題或建議，請透過以下方式聯絡：
- 電子郵件：liaobk@email.ntou.edu.tw
- Lab Web page： http://lbk.tw/
